<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Tío Viruelas</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Rock+Salt&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
  margin:0;
  background:#111;
  font-family:'Rock Salt', cursive;
  color:#C88713;
  text-align:center;
}

header{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:20px;
  padding:30px 10px;
}

.logo{
  width:120px;
  height:120px;
  border-radius:50%;
  overflow:hidden;
  border:4px solid #C88713;
}
.logo img{width:100%;height:100%;object-fit:cover;}

h1{font-size:3rem;margin:0;}

.volumenes{
  display:flex;
  overflow-x:auto;
  gap:20px;
  padding:20px;
  justify-content:center;
}
.vol-btn{
  padding:10px 20px;
  border:2px solid #C88713;
  border-radius:30px;
  cursor:pointer;
}
.vol-btn.activo{
  box-shadow:0 0 15px #C88713;
}

.tocadiscos{
  position:relative;
  width:360px;
  height:360px;
  margin:30px auto;
}

.vinilo{
  width:100%;
  height:100%;
  border-radius:50%;
  background:repeating-radial-gradient(circle,#000 0,#111 2px,#000 4px);
  animation:girar 16s linear infinite;
}
.vinilo.rapido{animation-duration:8s;}

@keyframes girar{to{transform:rotate(360deg)}}

.galleta{
  position:absolute;
  width:40%;
  height:40%;
  border-radius:50%;
  top:30%;
  left:30%;
  border:4px solid #C88713;
}

.brazo{
  position:absolute;
  top:-10%;
  right:-10%;
  width:40%;
  transition:1s;
}
.brazo.activo{transform:rotate(20deg) translate(-10%,20%);}

.vu{
  width:300px;
  margin:30px auto;
  position:relative;
}
.vu img{width:100%;}
.aguja{
  position:absolute;
  bottom:18%;
  left:50%;
  width:3px;
  height:70px;
  background:#C88713;
  transform-origin:bottom;
  transform:rotate(-45deg);
  transition:0.5s;
}

.canciones{
  max-width:600px;
  margin:auto;
}
.canciones div{
  padding:10px;
  cursor:pointer;
  border-bottom:1px solid #333;
}
.canciones div:hover{background:#222;}

#info{
  white-space:pre-line;
  background:#222;
  margin:20px auto;
  padding:15px;
  border-radius:10px;
  max-width:600px;
}

.controles{
  display:flex;
  justify-content:center;
  gap:15px;
  margin:20px;
}
.controles button{
  width:50px;height:50px;
  border-radius:50%;
  border:2px solid #C88713;
  background:#222;
  color:#C88713;
  font-size:1.2rem;
}
</style>
</head>

<body>

<header>
  <div class="logo"><img src="img/logo.jpeg"></div>
  <h1>El Tío Viruelas</h1>
</header>

<div class="volumenes" id="volumenes"></div>

<div class="tocadiscos">
  <img src="img/tocadiscos.png" class="brazo" id="brazo">
  <div class="vinilo" id="vinilo">
    <img class="galleta" id="galleta">
  </div>
</div>

<div class="vu">
  <img src="img/vu-meter.png">
  <div class="aguja" id="aguja"></div>
</div>

<div class="canciones" id="canciones"></div>
<div id="info">Selecciona una canción</div>

<audio id="player"></audio>

<div class="controles">
  <button onclick="player.play()"><i class="fas fa-play"></i></button>
  <button onclick="player.pause()"><i class="fas fa-pause"></i></button>
</div>

<script>
let data, volActual, player=document.getElementById('player');

fetch('data.json').then(r=>r.json()).then(json=>{
  data=json;
  crearVolumenes();
});

function crearVolumenes(){
  const cont=document.getElementById('volumenes');
  data.volumenes.forEach(v=>{
    const b=document.createElement('div');
    b.textContent=v.titulo;
    b.className='vol-btn';
    b.onclick=()=>cargarVolumen(v,b);
    cont.appendChild(b);
  });
}

function cargarVolumen(v,btn){
  document.querySelectorAll('.vol-btn').forEach(b=>b.classList.remove('activo'));
  btn.classList.add('activo');
  volActual=v;
  moverAguja(v.vu);
  cargarCanciones(v.canciones);
}

function moverAguja(valor){
  const aguja=document.getElementById('aguja');
  aguja.style.transform=`rotate(${valor*4}deg)`;
}

function cargarCanciones(canciones){
  const cont=document.getElementById('canciones');
  cont.innerHTML='';
  canciones.forEach(c=>{
    const d=document.createElement('div');
    d.textContent=c.titulo;
    d.onclick=()=>reproducir(c);
    cont.appendChild(d);
  });
}

async function reproducir(c){
  player.src=c.audio;
  await player.play();
  document.getElementById('galleta').src=c.galleta;
  document.getElementById('vinilo').classList.add('rapido');
  document.getElementById('brazo').classList.add('activo');

  const letra=await fetch(c.letra).then(r=>r.text());
  const extra=await fetch(c.extra).then(r=>r.text());
  document.getElementById('info').textContent=letra+"\n\n"+extra;
}
</script>

</body>
</html>

